class UniversalTilt{constructor(t,e={}){t.length>0?this.init(t,e):0!==t.length&&(this.element=t,this.width=null,this.height=null,this.left=null,this.top=null,this.timeout=null,this.settings=this.settings(e),this.reverse=this.settings.reverse?-1:1,this.settings.shine&&this.shine(),this.element.style.transform=`perspective(${this.settings.perspective}px)`,this.addEventListeners())}init(t,e){for(let i=0;i<t.length;i++)this.universalTilt=new UniversalTilt(t[i],e)}isMobile(){if(window.DeviceMotionEvent&&"ontouchstart"in document.documentElement)return!0}addEventListeners(){this.isMobile()?(this.onDeviceMoveBind=this.onDeviceMove.bind(this),window.addEventListener("devicemotion",this.onDeviceMoveBind)):(this.onMouseMoveBind=this.onMouseMove.bind(this),"element"===this.settings["position-base"]?this.base=this.element:"window"===this.settings["position-base"]&&(this.base=window),this.base.addEventListener("mouseenter",()=>this.onMouseEnter()),this.base.addEventListener("mousemove",this.onMouseMoveBind),this.base.addEventListener("mouseleave",()=>this.onMouseLeave()))}onMouseEnter(t){this.updateElementPosition(),this.transitions()}onMouseMove(t){this.event=t,this.updateElementPosition(),window.requestAnimationFrame(()=>this.update())}onMouseLeave(t){this.transitions(),window.requestAnimationFrame(()=>this.reset())}onDeviceMove(t){this.update(),this.updateElementPosition(),this.transitions()}reset(){this.event={pageX:this.left+this.width/2,pageY:this.top+this.height/2},this.settings.reset&&(this.element.style.transform=`perspective(${this.settings.perspective}px) rotateX(0deg) rotateY(0deg) scale3d(1, 1, 1)`),this.settings.shine&&!this.settings["shine-save"]&&Object.assign(this.shineElement.style,{transform:"rotate(180deg) translate3d(-50%, -50%, 0)",opacity:"0"}),this.settings.shadow&&!this.settings["shadow-save"]&&(this.element.style.boxShadow="0 45px 100px rgba(0, 0, 0, 0)")}getValues(){let t,e;if(this.isMobile()){t=event.accelerationIncludingGravity.x/4,e=event.accelerationIncludingGravity.y/4;let i,s;90===window.orientation?(s=(1-e)/2,e=i=(1+t)/2,t=s):-90===window.orientation?(s=(1+e)/2,e=i=(1-t)/2,t=s):0===window.orientation?(e=s=(1+e)/2,t=i=(1+t)/2):180===window.orientation&&(e=s=(1-e)/2,t=i=(1-t)/2)}else"element"===this.settings["position-base"]?(t=(this.event.clientX-this.left)/this.width,e=(this.event.clientY-this.top)/this.height):(t=this.event.clientX/window.innerWidth,e=this.event.clientY/window.innerHeight);t=Math.min(Math.max(t,0),1),e=Math.min(Math.max(e,0),1);let i=(this.settings.max/2-t*this.settings.max).toFixed(2),s=(e*this.settings.max-this.settings.max/2).toFixed(2),n=Math.atan2(t-.5,.5-e)*(180/Math.PI);return{tiltX:this.reverse*i,tiltY:this.reverse*s,angle:n}}updateElementPosition(){let t=this.element.getBoundingClientRect();this.width=this.element.offsetWidth,this.height=this.element.offsetHeight,this.left=t.left,this.top=t.top}update(){let t=this.getValues();this.settings.shadow&&(this.boxShadow=`0 45px 100px ${this.settings["shadow-color"]}`),this.element.style.transform=`perspective(${this.settings.perspective}px)\n     rotateX(${this.settings.disabled&&"X"===this.settings.disabled.toUpperCase()?0:t.tiltY}deg)\n     rotateY(${this.settings.disabled&&"Y"===this.settings.disabled.toUpperCase()?0:t.tiltX}deg)\n     scale3d(${this.settings.scale}, ${this.settings.scale}, ${this.settings.scale})`,this.settings.shine&&Object.assign(this.shineElement.style,{transform:`rotate(${t.angle}deg) translate3d(-50%, -50%, 0)`,opacity:`${this.settings["shine-opacity"]}`}),this.settings.shadow&&(this.element.style.boxShadow=this.boxShadow),this.element.dispatchEvent(new CustomEvent("tiltChange",{detail:t}))}shine(){const t=document.createElement("div");t.classList.add("shine");const e=document.createElement("div");e.classList.add("shine-inner"),t.appendChild(e),this.element.appendChild(t),this.shineWrapper=this.element.querySelector(".shine"),this.shineElement=this.element.querySelector(".shine-inner"),Object.assign(this.shineWrapper.style,{position:"absolute",top:"0",left:"0",height:"100%",width:"100%",overflow:"hidden"}),Object.assign(this.shineElement.style,{position:"absolute",top:"50%",left:"50%","pointer-events":"none","background-image":"linear-gradient(0deg, rgba(255,255,255,0) 0%, rgba(255,255,255,1) 100%)",width:`${2*this.element.offsetWidth}px`,height:`${2*this.element.offsetWidth}px`,transform:"rotate(180deg) translate3d(-50%, -50%, 0)","transform-origin":"0% 0%",opacity:"0"})}transitions(){clearTimeout(this.timeout),this.element.style.transition=`all ${this.settings.speed}ms ${this.settings.easing}`,this.settings.shine&&(this.shineElement.style.transition=`opacity ${this.settings.speed}ms ${this.settings.easing}`),this.timeout=setTimeout(()=>{this.element.style.transition="",this.settings.shine&&(this.shineElement.style.transition="")},this.settings.speed)}settings(t){let e={"position-base":"element",reset:!0,shadow:!1,"shadow-save":!1,"shadow-color":"rgba(0, 0, 0, 0.4)",shine:!1,"shine-opacity":0,"shine-save":!1,max:35,perspective:1e3,scale:1,disabled:null,reverse:!1,speed:300,easing:"cubic-bezier(.03,.98,.52,.99)"},i={};for(let s in e)if(s in t)i[s]=t[s];else if(this.element.getAttribute(`data-${s}`)){let t=this.element.getAttribute(`data-${s}`);try{i[s]=JSON.parse(t)}catch(e){i[s]=t}}else i[s]=e[s];return i}}let autoInit=new UniversalTilt(document.querySelectorAll("[data-tilt]"));if(window.jQuery){window.jQuery.fn.universalTilt=function(t){new UniversalTilt(this,t)}}"function"==typeof define&&define.amd?define("UniversalTilt",[],function(){return UniversalTilt}):"undefined"==typeof exports||exports.nodeType||("undefined"!=typeof module&&!module.nodeType&&module.exports&&(exports=module.exports=UniversalTilt),exports.default=UniversalTilt);